<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>T.A.R.A Safety Intelligence</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
    background:#04060d;
    color:white;
    font-family:Arial;
    text-align:center;
    margin:0;
}


/* AVATAR */

#avatarContainer{
    margin-top:25px;
    position:relative;
}

#avatar{
    width:220px;
    border-radius:50%;
    z-index:2;
    position:relative;
}

/* glowing ring */

#ring{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:260px;
    height:260px;
    border-radius:50%;
    border:3px solid #00ffc3;
    opacity:.35;
    animation:pulse 4s infinite;
}

/* talking state */

.talking{
    animation:talk 0.35s infinite alternate;
    opacity:.9;
}

/* subtle idle */

@keyframes pulse{
    0%{transform:translate(-50%,-50%) scale(1);}
    50%{transform:translate(-50%,-50%) scale(1.05);}
    100%{transform:translate(-50%,-50%) scale(1);}
}

/* faster talking pulse */

@keyframes talk{
    from{
        transform:translate(-50%,-50%) scale(1);
        border-color:#00ffc3;
    }
    to{
        transform:translate(-50%,-50%) scale(1.18);
        border-color:#ffffff;
    }
}


/* CHAT */

#chat{
    height:420px;
    max-width:600px;
    margin:20px auto;
    background:#0c1220;
    padding:15px;
    border-radius:10px;
    overflow-y:auto;
    text-align:left;
}

.user{
    background:#1b2540;
    padding:12px;
    margin:8px;
    border-radius:8px;
}

.tara{
    background:#00ffc3;
    color:black;
    padding:12px;
    margin:8px;
    border-radius:8px;
}


/* INPUT AREA */

#inputArea{
    margin-top:10px;
}

#question{
    width:70%;
    padding:16px;
    font-size:17px;
    border-radius:8px;
    border:none;
}


/* BUTTONS under input */

#buttons{
    margin-top:10px;
}

button{
    padding:14px 26px;
    font-size:16px;
    margin:6px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

#askBtn{
    background:#00ffc3;
}

#voiceBtn{
    background:orange;
}


/* LOGO */

#logo{
    width:150px;
    margin-top:20px;
}


/* POWERED TEXT */

#powered{
    font-size:18px;
    font-weight:bold;
    margin-top:10px;
}


/* COPYRIGHT */

#copyright{
    font-size:11px;
    opacity:.6;
    margin-top:25px;
    margin-bottom:10px;
}

</style>
</head>

<body>


<h2>T.A.R.A Safety Intelligence</h2>


<div id="avatarContainer">

<div id="ring"></div>

<img id="avatar" src="tara-avatar.png">

</div>



<div id="chat"></div>



<div id="inputArea">

<input id="question" placeholder="Ask T.A.R.A about towing safety">

<div id="buttons">

<button id="askBtn">Send</button>

<button id="voiceBtn">ðŸŽ¤ Speak</button>

</div>

</div>



<img id="logo" src="taralogo.jpg">


<div id="powered">
Powered by Safety Intelligence
</div>


<div id="copyright">
Â© Safety Buzz Alerts. All rights reserved.
</div>



<script>

const chat=document.getElementById("chat");
const input=document.getElementById("question");
const ring=document.getElementById("ring");


function add(text,type){

const div=document.createElement("div");

div.className=type;

div.innerText=text;

chat.appendChild(div);

chat.scrollTop=chat.scrollHeight;

}


function speak(text){

const speech=new SpeechSynthesisUtterance(text);

speech.rate=.95;

/* start mouth */

speech.onstart=()=>{
ring.classList.add("talking");
};

/* stop mouth */

speech.onend=()=>{
ring.classList.remove("talking");
};

speechSynthesis.cancel();
speechSynthesis.speak(speech);

}


async function ask(){

const q=input.value.trim();

if(!q)return;

add("You: "+q,"user");

input.value="";

add("T.A.R.A is analyzing...","tara");


try{

const res=await fetch("/ask",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({question:q})

});

const data=await res.json();

chat.lastChild.remove();

add("T.A.R.A: "+data.answer,"tara");

speak(data.answer);

}
catch{

chat.lastChild.remove();

const fallback="Check tow points, secure vehicle, and follow manufacturer safety procedures.";

add("T.A.R.A: "+fallback,"tara");

speak(fallback);

}

}


askBtn.onclick=ask;


input.addEventListener("keypress",e=>{
if(e.key==="Enter")ask();
});


/* VOICE INPUT */

if("webkitSpeechRecognition"in window){

const rec=new webkitSpeechRecognition();

rec.continuous=false;

rec.onresult=e=>{

input.value=e.results[0][0].transcript;

ask();

};

voiceBtn.onclick=()=>rec.start();

}
else{

voiceBtn.style.display="none";

}

</script>

</body>
</html>
