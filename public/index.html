<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Safety Intelligence AI</title>

<style>

body{
font-family:Arial;
background:#0b0f14;
color:white;
text-align:center;
margin:0;
display:flex;
flex-direction:column;
height:100vh;
}

#avatar{
width:240px;
margin:15px auto 5px auto;
animation:pulse 4s infinite;
}

@keyframes pulse{
0%{transform:scale(1);}
50%{transform:scale(1.04);}
100%{transform:scale(1);}
}

.talking{
animation:talk 0.35s infinite alternate;
}

@keyframes talk{
from{transform:scale(1);}
to{transform:scale(1.1);}
}

#chat{
flex:1;
width:90%;
max-width:600px;
margin:auto;
background:#111;
padding:15px;
overflow-y:auto;
border-radius:10px;
text-align:left;
}

.user{
color:#4FC3F7;
margin:10px 0;
}

.ai{
color:#81C784;
margin:10px 0;
}

#controls{
margin:10px;
}

input{
width:60%;
padding:12px;
font-size:16px;
}

button{
padding:12px 18px;
font-size:16px;
margin:5px;
cursor:pointer;
}

#logo{
width:140px;
opacity:0.85;
margin-top:10px;
}

#footer{
font-size:14px;
opacity:0.7;
margin-bottom:10px;
}

</style>
</head>
<body>


<img id="avatar" src="avatar.png">


<div id="chat"></div>


<div id="controls">

<input id="question" placeholder="Ask Safety Intelligence...">

<button onclick="send()">Send</button>

<button id="micBtn" onclick="toggleMic()">ðŸŽ¤ Mic</button>

</div>


<img id="logo" src="logo.png">


<div id="footer">
Powered by Safety Intelligence<br>
This is our test prototype and my dad is still working on me
</div>


<script>

let recognizing=false;
let recognition;


function addMessage(text,cls){

const chat=document.getElementById("chat");

const div=document.createElement("div");

div.className=cls;

div.innerText=text;

chat.appendChild(div);

chat.scrollTop=chat.scrollHeight;

}


async function send(){

const input=document.getElementById("question");

const text=input.value;

if(!text)return;

addMessage("YOU: "+text,"user");

input.value="";

const res=await fetch("/ask",{

method:"POST",

headers:{"Content-Type":"application/json"},

body:JSON.stringify({question:text})

});

const data=await res.json();

addMessage("AI: "+data.answer,"ai");

speak(data.answer);

}


function speak(text){

const avatar=document.getElementById("avatar");

avatar.classList.add("talking");

const utter=new SpeechSynthesisUtterance(text);

utter.rate=0.95;

utter.pitch=1;

utter.volume=1;

utter.onend=function(){

avatar.classList.remove("talking");

};

speechSynthesis.cancel();

speechSynthesis.speak(utter);

}



function toggleMic(){

if(!('webkitSpeechRecognition'in window)){

alert("Chrome required");

return;

}

if(!recognizing){

recognition=new webkitSpeechRecognition();

recognition.continuous=false;

recognition.interimResults=false;

recognition.lang="en-US";

recognition.onresult=function(event){

document.getElementById("question").value=
event.results[0][0].transcript;

send();

};

recognition.onend=function(){

recognizing=false;

document.getElementById("micBtn").innerText="ðŸŽ¤ Mic";

};

recognition.start();

recognizing=true;

document.getElementById("micBtn").innerText="â›” Stop";

}else{

recognition.stop();

recognizing=false;

document.getElementById("micBtn").innerText="ðŸŽ¤ Mic";

}

}

</script>

</body>
</html>
