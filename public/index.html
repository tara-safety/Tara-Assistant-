<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>T.A.R.A</title>

<style>

body {

    margin: 0;
    font-family: Arial, sans-serif;
    background: black;
    color: white;
    text-align: center;
}

.container {

    padding: 15px;
}


/* Avatar container */
#avatarContainer {

    position: relative;

    width: 220px;      /* desktop size */

    max-width: 60vw;   /* mobile safe */

    margin: 20px auto;
}


/* Avatar image */
#avatar {

    width: 100%;

    height: auto;

    display: block;
}


/* Mouth overlay */
#mouth {

    position: absolute;

    left: 50%;

    transform: translateX(-50%);

    bottom: 28%;   /* percentage fixes all screen sizes */

    width: 22%;

    height: 6%;

    background: limegreen;

    border-radius: 20px;

    opacity: 0;

    pointer-events: none;
}


.talking {

    opacity: 1;

    animation: mouthMove 0.15s infinite alternate;
}


@keyframes mouthMove {

    from {
        transform: translateX(-50%) scaleY(1);
    }

    to {
        transform: translateX(-50%) scaleY(1.9);
    }
}


/* Thinking bubble */
#thinking {

    position: absolute;

    top: -25px;

    left: 50%;

    transform: translateX(-50%);

    font-size: 22px;

    opacity: 0;
}

.thinkingActive {

    opacity: 1;

    animation: blink 1s infinite;
}


@keyframes blink {

    0%{opacity:0;}
    50%{opacity:1;}
    100%{opacity:0;}
}


/* Input */
textarea {

    width: 90%;

    max-width: 400px;

    height: 80px;

    font-size: 16px;
}


/* Buttons */
button {

    width: 130px;

    height: 45px;

    font-size: 16px;

    margin: 8px;
}


/* Logo */
#logo {

    width: 110px;

    margin-top: 10px;
}


/* Powered text */
#powered {

    font-size: 18px;

    margin-top: 6px;
}


/* Copyright */
#copyright {

    margin-top: 30px;

    font-size: 12px;

    opacity: 0.5;
}


/* Mobile adjustments */
@media (max-width:600px){

    #avatarContainer {

        width: 180px;
    }

}


/* THINKING DOTS */

#thinking{

height:25px;

margin:5px;

color:#00eaff;

opacity:0;

font-size:18px;

}


/* CHAT */

#chat{

width:90%;
max-width:520px;

height:300px;

margin:15px auto;

padding:15px;

background:#0b1c2a;

border-radius:15px;

overflow-y:auto;

text-align:left;

}


/* INPUT */

#question{

width:85%;
max-width:420px;

padding:14px;

border-radius:10px;

border:none;

font-size:16px;

}


/* BUTTONS */

.controls{

margin-top:10px;

}

button{

padding:14px 22px;

margin:5px;

border:none;

border-radius:10px;

font-size:16px;

cursor:pointer;

}

#sendBtn{

background:#00bcd4;
color:white;

}

#voiceBtn{

background:#00eaff;
color:black;

}


/* LOGO */

#logo{

width:140px;
margin-top:20px;

}


/* POWERED */

.powered{

font-size:20px;
color:#00eaff;
margin-top:10px;

}


/* FOOTER */

.footer{

font-size:11px;
color:#777;
margin-top:25px;

}

</style>
</head>
<body>


<div id="avatarcontainer">

<img id="avatar" src="tara-avatar.png">

<div id="mouth"></div>

</div>


<h1 style="color:#00eaff">T.A.R.A</h1>

<div>Towing Awareness & Risk Assistant</div>


<div id="thinking">
T.A.R.A is thinking...
</div>


<div id="chat"></div>


<input id="question" placeholder="Ask T.A.R.A about towing safety...">


<div class="controls">

<button id="sendBtn">
Send
</button>

<button id="voiceBtn">
ðŸŽ¤ Speak
</button>

</div>


<img id="logo" src="taralogo.jpg">


<div class="powered">
Powered by Safety Intelligence
</div>


<div class="footer">
Â© 2026 T.A.R.A Safety Intelligence
</div>



<script>

const chat = document.getElementById("chat");

const input = document.getElementById("question");

const mouth = document.getElementById("mouth");

const thinking = document.getElementById("thinking");


let talking=false;



function addMessage(sender,text){

const div=document.createElement("div");

div.style.margin="8px";

if(sender==="user")
div.innerHTML="<b>You:</b> "+text;
else
div.innerHTML="<b>T.A.R.A:</b> "+text;

chat.appendChild(div);

chat.scrollTop=chat.scrollHeight;

}



async function send(){

const text=input.value.trim();

if(!text) return;

addMessage("user",text);

input.value="";


thinking.style.opacity=1;


try{

const res=await fetch("/ask",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
question:text
})

});


const data=await res.json();


thinking.style.opacity=0;


addMessage("tara",data.answer);


speak(data.answer);


}
catch{

thinking.style.opacity=0;

addMessage("tara","Connection error.");

}

}



document.getElementById("sendBtn").onclick=send;


input.addEventListener("keypress",e=>{

if(e.key==="Enter")
send();

});



/* VOICE INPUT */

let recognition;

if("webkitSpeechRecognition" in window){

recognition=new webkitSpeechRecognition();

recognition.onresult=e=>{

input.value=e.results[0][0].transcript;

send();

};

}


document.getElementById("voiceBtn").onclick=()=>{

if(recognition)
recognition.start();

};



/* VOICE OUTPUT */

function speak(text){

if(!speechSynthesis) return;

const utter=new SpeechSynthesisUtterance(text);

utter.rate=1;

utter.pitch=1;

utter.onstart=()=>talking=true;

utter.onend=()=>talking=false;

speechSynthesis.speak(utter);

}



/* MOUTH ANIMATION */

function animate(){

if(talking){

mouth.style.opacity=Math.random()>0.5?1:0.2;

mouth.style.height=(Math.random()*20+10)+"px";

}

else{

mouth.style.opacity=0;

}


requestAnimationFrame(animate);

}


animate();



</script>

</body>
</html>
